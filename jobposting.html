<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
	<title>SubicJobs</title>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
	<link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
</head>
<body>
	<nav class="  blue lighten-1 " role="navigation">
		<div class="nav-wrapper container">
			<ul class="right hide-on-med-and-down">
				<li><a href="" id="link1"><img src="icons/sign-in.png" class="icon">Back</a></li>
				<li><a href="index.html"><img src="icons/sign-in.png" class="icon"> Logout</a></li>
				
			</ul>
		</div>
	</nav>
	
	<div class="col s12">
			<div class="card z-depth-5">
				<div class="card-image" >
					<img id="cdImg" src="bground354.jpg">
				</div>
				<div class="col s12 center" id="imgSze">
					<img src="icons/e1.png" width="95px" height="95px" class="circle">
				</div>
				
			    <div id="hello" class="card-content center">
				<h4 id="hi"></h4>
        		</div>
				
		</div>
	</div>	
	<h3 class="register"><img src="icons/r2.png" class="icon">New Job Posting</h3><br>
	<div class="row wew">
		<form method="post" id="savepost" class="col s12">
			<div class="row">
				<div class="input-field col s12">
					<input id="locators_id" name="locators_id" type="hidden" class="validate">
					<input id="jobpost_title" name="jobpost_title" type="text" class="validate">
					<label for="jobpost_title">Title</label>
				</div>
			</div>
			<div class="row">
				<div class="input-field col s12">
					<input type="date" class="datepicker" id="jobpost_date_closing" name="jobpost_date_closing" />
					<label for="jobpost_date_closing">Closing Date</label>
				</div>
			</div>
			<div class="row">
				<div class="input-field col s12">
					<input id="jobpost_numapp" name="jobpost_numapp" type="number" class="validate">
					<label for="jobpost_numapp">Number of Applicants</label>
				</div>
			</div>
			<div class="row">
				<div class="input-field col s12">
					<textarea name="jobpost_description" id="jobpost_description" class="materialize-textarea"></textarea>
					<label for="jobpost_description">Qualifications</label>
				</div>
			</div>
			<div id="skillset" class="row">
			</div>			
			<button class="btn waves-effect waves-light btn-large right responsive-button" type="submit" name="savePosting" id="savePosting">Submit
				<i class="material-icons right">send</i>
			</button>
		</form>
	</div>
	
	<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script src="js/materialize.js"></script>
	<script src="js/init.js"></script>
	<script>
	$(document).ready(function(){
		function getUrlParameter(sParam) {
			var sPageURL = decodeURIComponent(window.location.search.substring(1)),
				sURLVariables = sPageURL.split('&'),
				sParameterName,
				i;

			for (i = 0; i < sURLVariables.length; i++) {
				sParameterName = sURLVariables[i].split('=');

				if (sParameterName[0] === sParam) {
					return sParameterName[1] === undefined ? true : sParameterName[1];
				}
			}
		}
		
		var locId = getUrlParameter('locId');
		
		$("#locators_id").val(locId);
		$("#link1").attr("href", "company.html?locId="+locId);
		
		$("#savePosting").click(function() {
			var data = $("#savepost").serialize();
			
			$.ajax({
				type : 'POST',
				url  : 'http://wwww.grand-pillar.com/uploads/subicjobssbma/savePostingData.php',
				data : data,
				success :  function(response) {
					$('#jobpost_title').val('');
					$('#jobpost_date_closing').val('');
					$('#jobpost_description').val('');
					$('#jobpost_numapp').val('');
					$('.chkbox').attr('checked', false);
					window.alert('Request Successful');
					
				}
			});	

			return false;
		});	
		
		$.getJSON('http://wwww.grand-pillar.com/uploads/subicjobssbma/loadData.php?loc='+locId, function(json) {
			$("#hi").text(json.locators_name);		
		});
		
		$.getJSON('http://wwww.grand-pillar.com/uploads/subicjobssbma/loadData.php?category=true', function(json) {
			$.each(json, function (key, val) {
				$('#skillset').append('<div class="input-field col s4"><p><input type="checkbox" name="skills[]" value=" '+val.category_id+' " id="index'+key+'" class="chkbox" /><label for="index'+key+'">'+val.category_title+'</label></p></div>');
			});	
		});		
		
		$('.datepicker').pickadate({
			selectMonths: true, // Creates a dropdown to control month
			selectYears: 16 // Creates a dropdown of 15 years to control year
		});		
	});
	</script>	
	
	<div class="footer-copyright  blue lighten-1">
		<div class="container">
			<a class="white-text" href="#">Copyright. All Rights Reserved</a>
		</div>
	</div> 
</body>
</html>